--AQUI PONEMOS LAS PLANILLAS QUE NO APARECEN EN EL REPORTE
SELECT
	A.EMPRESA,
	A.PLANILLA, 
	A.NUEVA_PLANILLA,
    CASE
		WHEN A.PLANILLA = 'PLANILLA LIQUIDADOS' THEN A.NUEVA_PLANILLA
		ELSE A.PLANILLA
		END AS 'PLANILLA BIEN',
	a.Departamento, a.[Dpto Negocio],
	Situacion_Credito, Origen_Coopac, 
	P.EMPRESA, 
    P.PLANILLA_CORREGIDA as 'PLANILLA_CORREGIDA',
	a.Departamento

FROM  
	anexos_riesgos2..Anx06_preliminar A

LEFT JOIN Anexos_Riesgos..PLANILLA2 P
	ON (LTRIM(RTRIM(A.NUEVA_PLANILLA)) =  LTRIM(RTRIM(P.NUEVA_PLANILLA)))
	WHERE FechaCorte1 = '20231130'
AND
	PLANILLA like '%cañete%yauy%'

--AQUÍ LAS BUSCAMOS EN LA TABLA DE PLANILLAS
DECLARE @EMPRESANILLA VARCHAR(50) = '%cañete%yauy%nombr%'
SELECT * FROM  Anexos_Riesgos..planilla2
WHERE NUEVA_PLANILLA LIKE @EMPRESANILLA
OR NUEVA_PLANILLA_creada LIKE @EMPRESANILLA
OR Empresa LIKE @EMPRESANILLA
OR planilla_corregida LIKE @EMPRESANILLA

-- update anexos_riesgos2..anx06_preliminar
-- set NUEVA_PLANILLA = 'DIRECCION REGIONAL DE SALUD TUMBES - NOMBRADOS'
-- where NUEVA_PLANILLA = 'DIRECCION REGIONAL DE SALUD TUMBES - ACTIVOS'

----------------------------------------------
--AQUÍ LAS AÑADIMOS PARA QUE APAREZCAN
-- LA COLUMNA NUEVA_PLANILLA_creada debe tener el nombre correcto
-- LA COLUMNA NUEVA_PLANILLA tiene el nombre que queremos corregir
INSERT INTO Anexos_Riesgos..planilla2
VALUES (
'SERVICIOS BASICOS DE SALUD-CAÑETE-YAUYOS - NOBRADOS',
'SERVICIOS BASICOS DE SALUD-CAÑETE-YAUYOS - NOBRADOS',
'SERVICIOS BASICOS DE SALUD-CAÑETE-YAUYOS',
'SERVICIOS BASICOS DE SALUD-CAÑETE-YAUYOS - NOBRADOS'
        )

		update Anexos_Riesgos..planilla2
		set NUEVA_PLANILLA_creada = 'UNIVERSIDAD NACIONAL DE TUMBES - ACTIVOS'
		WHERE NUEVA_PLANILLA = 'UNIVERSIDAD NACIONAL DE TUMBES - ACTIVOS'


